module.exports=[77585,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(15925),f=a.i(32886),g=a.i(97895);function h(){let a=(0,e.useTranslations)("checkout"),h=(0,e.useTranslations)("cart"),i=(0,f.useLocale)(),j=(0,d.useRouter)(),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)({shippingName:"",shippingAddressLine1:"",shippingAddressLine2:"",shippingCity:"",shippingPostalCode:"",shippingCountry:"SE",shippingPhone:"",shippingRegionId:"",paymentMethod:""}),[w,x]=(0,c.useState)(0),[y,z]=(0,c.useState)(null);(0,c.useEffect)(()=>{B()},[]);let A=k.reduce((a,b)=>a+(b.variant?.price??b.product?.price??0)*b.quantity,0);(0,c.useEffect)(()=>{u.shippingRegionId&&A>0&&C()},[u.shippingRegionId,A]);let B=async()=>{try{let a=await fetch("/api/cart"),b=await a.json();l(b.items||[]);let c=await fetch("/api/shipping/regions"),d=await c.json();if(n(d.regions||[]),d.regions&&d.regions.length>0){let a=d.regions.find(a=>"SE"===a.code)||d.regions[0];v(b=>({...b,shippingRegionId:a.id})),z(a)}}catch(a){console.error("Error fetching checkout data:",a),t("Failed to load checkout data")}finally{p(!1)}},C=async()=>{let a=k.reduce((a,b)=>a+(b.variant?.price??b.product?.price??0)*b.quantity,0);if(u.shippingRegionId&&0!==a)try{let b=m.find(a=>a.id===u.shippingRegionId);if(!b)return;let c=await fetch("/api/shipping/calculate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({regionCode:b.code,subtotal:a})}),d=await c.json();void 0!==d.shippingCost&&x(d.shippingCost)}catch(a){console.error("Error calculating shipping:",a)}},D=.25*A,E=A+w+D,F=async a=>{if(a.preventDefault(),t(""),r(!0),!u.paymentMethod){t("Please select a payment method"),r(!1);return}try{let a=await fetch("/api/checkout/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),b=await a.json();if(b.error){t(b.error),r(!1);return}b.order&&j.push(`/orders/${b.order.order_number}`)}catch(a){t("Failed to create order. Please try again."),r(!1)}},G=a=>{let{name:b,value:c}=a.target;v(a=>({...a,[b]:c})),"shippingRegionId"===b&&z(m.find(a=>a.id===c)||null)};return o?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading checkout..."})]})}):0===k.length?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Your cart is empty"}),(0,b.jsx)("button",{onClick:()=>j.push("/shop"),className:"text-indigo-600 hover:text-indigo-500",children:"Continue Shopping"})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:a("title")}),(0,b.jsxs)("form",{onSubmit:F,className:"lg:grid lg:grid-cols-12 lg:gap-x-12",children:[(0,b.jsxs)("div",{className:"lg:col-span-7",children:[(0,b.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:a("shippingInfo")}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingName",className:"block text-sm font-medium text-gray-700",children:"Full Name *"}),(0,b.jsx)("input",{type:"text",id:"shippingName",name:"shippingName",required:!0,value:u.shippingName,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingAddressLine1",className:"block text-sm font-medium text-gray-700",children:"Address Line 1 *"}),(0,b.jsx)("input",{type:"text",id:"shippingAddressLine1",name:"shippingAddressLine1",required:!0,value:u.shippingAddressLine1,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingAddressLine2",className:"block text-sm font-medium text-gray-700",children:"Address Line 2"}),(0,b.jsx)("input",{type:"text",id:"shippingAddressLine2",name:"shippingAddressLine2",value:u.shippingAddressLine2,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingCity",className:"block text-sm font-medium text-gray-700",children:"City *"}),(0,b.jsx)("input",{type:"text",id:"shippingCity",name:"shippingCity",required:!0,value:u.shippingCity,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingPostalCode",className:"block text-sm font-medium text-gray-700",children:"Postal Code *"}),(0,b.jsx)("input",{type:"text",id:"shippingPostalCode",name:"shippingPostalCode",required:!0,value:u.shippingPostalCode,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingCountry",className:"block text-sm font-medium text-gray-700",children:"Country *"}),(0,b.jsxs)("select",{id:"shippingCountry",name:"shippingCountry",required:!0,value:u.shippingCountry,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[(0,b.jsx)("option",{value:"SE",children:"Sweden"}),(0,b.jsx)("option",{value:"NO",children:"Norway"}),(0,b.jsx)("option",{value:"DK",children:"Denmark"}),(0,b.jsx)("option",{value:"FI",children:"Finland"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingPhone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,b.jsx)("input",{type:"tel",id:"shippingPhone",name:"shippingPhone",value:u.shippingPhone,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"shippingRegionId",className:"block text-sm font-medium text-gray-700",children:"Shipping Region *"}),(0,b.jsxs)("select",{id:"shippingRegionId",name:"shippingRegionId",required:!0,value:u.shippingRegionId,onChange:G,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[(0,b.jsx)("option",{value:"",children:"Select region"}),m.map(a=>(0,b.jsx)("option",{value:a.id,children:"sv"===i?a.name_sv:a.name_en},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:a("paymentMethod")}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,b.jsx)("input",{type:"radio",name:"paymentMethod",value:"stripe",checked:"stripe"===u.paymentMethod,onChange:G,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),(0,b.jsxs)("div",{className:"ml-3",children:[(0,b.jsx)("div",{className:"font-medium text-gray-900",children:"Credit/Debit Card"}),(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Visa, Mastercard, Amex, Klarna"})]})]}),(0,b.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,b.jsx)("input",{type:"radio",name:"paymentMethod",value:"paypal",checked:"paypal"===u.paymentMethod,onChange:G,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),(0,b.jsxs)("div",{className:"ml-3",children:[(0,b.jsx)("div",{className:"font-medium text-gray-900",children:"PayPal"}),(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Pay with your PayPal account"})]})]})]})]}),s&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:(0,b.jsx)("p",{className:"text-sm text-red-800",children:s})})]}),(0,b.jsx)("div",{className:"lg:col-span-5 mt-8 lg:mt-0",children:(0,b.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 sticky top-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:a("orderSummary")}),(0,b.jsx)("div",{className:"border-b border-gray-200 pb-4 mb-4",children:k.map(a=>{let c=a.variant?.price??a.product?.price??0,d="sv"===i?a.product?.name_sv||a.product?.name_en||"":a.product?.name_en||"",e="sv"===i&&a.variant?.name_sv||a.variant?.name_en;return(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:d}),e&&(0,b.jsx)("p",{className:"text-gray-500 text-xs",children:e}),(0,b.jsxs)("p",{className:"text-gray-500",children:["Qty: ",a.quantity]})]}),(0,b.jsx)("p",{className:"text-gray-900 font-medium",children:(0,g.formatPrice)(c*a.quantity,"SEK")})]},a.id)})}),(0,b.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("dt",{className:"text-gray-600",children:h("subtotal")}),(0,b.jsx)("dd",{className:"text-gray-900",children:(0,g.formatPrice)(A,"SEK")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("dt",{className:"text-gray-600",children:h("shipping")}),(0,b.jsx)("dd",{className:"text-gray-900",children:0===w?(0,b.jsx)("span",{className:"text-green-600",children:"Free"}):(0,g.formatPrice)(w,"SEK")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("dt",{className:"text-gray-600",children:"Tax (VAT)"}),(0,b.jsx)("dd",{className:"text-gray-900",children:(0,g.formatPrice)(D,"SEK")})]}),(0,b.jsxs)("div",{className:"flex justify-between text-base font-semibold border-t border-gray-200 pt-2",children:[(0,b.jsx)("dt",{className:"text-gray-900",children:h("total")}),(0,b.jsx)("dd",{className:"text-gray-900",children:(0,g.formatPrice)(E,"SEK")})]})]}),(0,b.jsx)("button",{type:"submit",disabled:q,className:"w-full mt-6 bg-indigo-600 text-white py-3 px-4 rounded-md font-medium hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a(q?"processing":"placeOrder")})]})})]})]})})}a.s(["default",()=>h])}];

//# sourceMappingURL=app_%5Blocale%5D_checkout_page_tsx_e853300a._.js.map