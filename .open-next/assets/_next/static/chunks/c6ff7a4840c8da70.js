(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52871,e=>{"use strict";var s=e.i(43476),i=e.i(71645),t=e.i(18566),a=e.i(48148),n=e.i(61745),r=e.i(47163);function d(){let e=(0,a.useTranslations)("checkout"),d=(0,a.useTranslations)("cart"),l=(0,n.useLocale)(),o=(0,t.useRouter)(),[c,m]=(0,i.useState)([]),[h,p]=(0,i.useState)([]),[g,x]=(0,i.useState)(!0),[u,y]=(0,i.useState)(!1),[b,j]=(0,i.useState)(""),[f,N]=(0,i.useState)({shippingName:"",shippingAddressLine1:"",shippingAddressLine2:"",shippingCity:"",shippingPostalCode:"",shippingCountry:"SE",shippingPhone:"",shippingRegionId:"",paymentMethod:""}),[v,w]=(0,i.useState)(0),[C,P]=(0,i.useState)(null);(0,i.useEffect)(()=>{k()},[]);let S=c.reduce((e,s)=>e+(s.variant?.price??s.product?.price??0)*s.quantity,0);(0,i.useEffect)(()=>{f.shippingRegionId&&S>0&&A()},[f.shippingRegionId,S]);let k=async()=>{try{let e=await fetch("/api/cart"),s=await e.json();m(s.items||[]);let i=await fetch("/api/shipping/regions"),t=await i.json();if(p(t.regions||[]),t.regions&&t.regions.length>0){let e=t.regions.find(e=>"SE"===e.code)||t.regions[0];N(s=>({...s,shippingRegionId:e.id})),P(e)}}catch(e){console.error("Error fetching checkout data:",e),j("Failed to load checkout data")}finally{x(!1)}},A=async()=>{let e=c.reduce((e,s)=>e+(s.variant?.price??s.product?.price??0)*s.quantity,0);if(f.shippingRegionId&&0!==e)try{let s=h.find(e=>e.id===f.shippingRegionId);if(!s)return;let i=await fetch("/api/shipping/calculate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({regionCode:s.code,subtotal:e})}),t=await i.json();void 0!==t.shippingCost&&w(t.shippingCost)}catch(e){console.error("Error calculating shipping:",e)}},R=.25*S,F=S+v+R,L=async e=>{if(e.preventDefault(),j(""),y(!0),!f.paymentMethod){j("Please select a payment method"),y(!1);return}try{let e=await fetch("/api/checkout/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),s=await e.json();if(s.error){j(s.error),y(!1);return}s.order&&o.push(`/orders/${s.order.order_number}`)}catch(e){j("Failed to create order. Please try again."),y(!1)}},I=e=>{let{name:s,value:i}=e.target;N(e=>({...e,[s]:i})),"shippingRegionId"===s&&P(h.find(e=>e.id===i)||null)};return g?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading checkout..."})]})}):0===c.length?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Your cart is empty"}),(0,s.jsx)("button",{onClick:()=>o.push("/shop"),className:"text-indigo-600 hover:text-indigo-500",children:"Continue Shopping"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:e("title")}),(0,s.jsxs)("form",{onSubmit:L,className:"lg:grid lg:grid-cols-12 lg:gap-x-12",children:[(0,s.jsxs)("div",{className:"lg:col-span-7",children:[(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:e("shippingInfo")}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingName",className:"block text-sm font-medium text-gray-700",children:"Full Name *"}),(0,s.jsx)("input",{type:"text",id:"shippingName",name:"shippingName",required:!0,value:f.shippingName,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingAddressLine1",className:"block text-sm font-medium text-gray-700",children:"Address Line 1 *"}),(0,s.jsx)("input",{type:"text",id:"shippingAddressLine1",name:"shippingAddressLine1",required:!0,value:f.shippingAddressLine1,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingAddressLine2",className:"block text-sm font-medium text-gray-700",children:"Address Line 2"}),(0,s.jsx)("input",{type:"text",id:"shippingAddressLine2",name:"shippingAddressLine2",value:f.shippingAddressLine2,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingCity",className:"block text-sm font-medium text-gray-700",children:"City *"}),(0,s.jsx)("input",{type:"text",id:"shippingCity",name:"shippingCity",required:!0,value:f.shippingCity,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingPostalCode",className:"block text-sm font-medium text-gray-700",children:"Postal Code *"}),(0,s.jsx)("input",{type:"text",id:"shippingPostalCode",name:"shippingPostalCode",required:!0,value:f.shippingPostalCode,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingCountry",className:"block text-sm font-medium text-gray-700",children:"Country *"}),(0,s.jsxs)("select",{id:"shippingCountry",name:"shippingCountry",required:!0,value:f.shippingCountry,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[(0,s.jsx)("option",{value:"SE",children:"Sweden"}),(0,s.jsx)("option",{value:"NO",children:"Norway"}),(0,s.jsx)("option",{value:"DK",children:"Denmark"}),(0,s.jsx)("option",{value:"FI",children:"Finland"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingPhone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,s.jsx)("input",{type:"tel",id:"shippingPhone",name:"shippingPhone",value:f.shippingPhone,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"shippingRegionId",className:"block text-sm font-medium text-gray-700",children:"Shipping Region *"}),(0,s.jsxs)("select",{id:"shippingRegionId",name:"shippingRegionId",required:!0,value:f.shippingRegionId,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[(0,s.jsx)("option",{value:"",children:"Select region"}),h.map(e=>(0,s.jsx)("option",{value:e.id,children:"sv"===l?e.name_sv:e.name_en},e.id))]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:e("paymentMethod")}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,s.jsx)("input",{type:"radio",name:"paymentMethod",value:"stripe",checked:"stripe"===f.paymentMethod,onChange:I,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"Credit/Debit Card"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Visa, Mastercard, Amex, Klarna"})]})]}),(0,s.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,s.jsx)("input",{type:"radio",name:"paymentMethod",value:"paypal",checked:"paypal"===f.paymentMethod,onChange:I,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"PayPal"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Pay with your PayPal account"})]})]})]})]}),b&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:(0,s.jsx)("p",{className:"text-sm text-red-800",children:b})})]}),(0,s.jsx)("div",{className:"lg:col-span-5 mt-8 lg:mt-0",children:(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 sticky top-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:e("orderSummary")}),(0,s.jsx)("div",{className:"border-b border-gray-200 pb-4 mb-4",children:c.map(e=>{let i=e.variant?.price??e.product?.price??0,t="sv"===l?e.product?.name_sv||e.product?.name_en||"":e.product?.name_en||"",a="sv"===l&&e.variant?.name_sv||e.variant?.name_en;return(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-gray-900",children:t}),a&&(0,s.jsx)("p",{className:"text-gray-500 text-xs",children:a}),(0,s.jsxs)("p",{className:"text-gray-500",children:["Qty: ",e.quantity]})]}),(0,s.jsx)("p",{className:"text-gray-900 font-medium",children:(0,r.formatPrice)(i*e.quantity,"SEK")})]},e.id)})}),(0,s.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("dt",{className:"text-gray-600",children:d("subtotal")}),(0,s.jsx)("dd",{className:"text-gray-900",children:(0,r.formatPrice)(S,"SEK")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("dt",{className:"text-gray-600",children:d("shipping")}),(0,s.jsx)("dd",{className:"text-gray-900",children:0===v?(0,s.jsx)("span",{className:"text-green-600",children:"Free"}):(0,r.formatPrice)(v,"SEK")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("dt",{className:"text-gray-600",children:"Tax (VAT)"}),(0,s.jsx)("dd",{className:"text-gray-900",children:(0,r.formatPrice)(R,"SEK")})]}),(0,s.jsxs)("div",{className:"flex justify-between text-base font-semibold border-t border-gray-200 pt-2",children:[(0,s.jsx)("dt",{className:"text-gray-900",children:d("total")}),(0,s.jsx)("dd",{className:"text-gray-900",children:(0,r.formatPrice)(F,"SEK")})]})]}),(0,s.jsx)("button",{type:"submit",disabled:u,className:"w-full mt-6 bg-indigo-600 text-white py-3 px-4 rounded-md font-medium hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:e(u?"processing":"placeOrder")})]})})]})]})})}e.s(["default",()=>d])}]);